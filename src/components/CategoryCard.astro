---
import type { CuisineName } from "../types/cuisines";
import { cuisines } from "../utils/cuisine";
import { toCamelCaseAndRemoveSpecialChars } from "../utils/string";

export interface Props {
  name: string;
  count?: number;
  type: "cuisine" | "location";
  href?: string;
  color?: string;
}

const {
  name,
  count,
  type,
  href = "#",
  color = "var(--color-primary)",
} = Astro.props;

let image = "";

if (type === "cuisine") {
  const cuisine =
    cuisines[
      toCamelCaseAndRemoveSpecialChars(name).toLowerCase() as CuisineName
    ];

  image = "/images/reviews" + cuisine?.url || "";
}
---

<div class="category-card">
  <a href={href} class="category-card__link">
    <div>
      <div
        class="category-card__content"
        style={`background-image: url(${image});`}
      >
      </div>

      <div class="category-card__header" style={`background-color: ${color};`}>
        <h3 class="category-card__name">{name}</h3>
        {
          count && (
            <p class="category-card__count">
              {count} {count === 1 ? "review" : "reviews"}
            </p>
          )
        }
      </div>
    </div>
  </a>
</div>

<style>
  .category-card {
    background-color: var(--color-white);
    border: var(--custom-border);
  }

  .category-card__image {
    width: 100%;
    height: 20rem;
    object-fit: cover;
    filter: grayscale(100%);

    transition: filter var(--transition-normal);

    &:hover {
      filter: grayscale(0%);
    }
  }

  .category-card__link {
    display: block;
    text-decoration: none;
    color: inherit;
    position: relative;
  }

  .category-card__content {
    position: relative;
    z-index: 1;
    height: 20rem;
    background-size: cover;
    background-position: center; /* Center the image */

    filter: grayscale(100%);
    transition: filter var(--transition-normal);

    &:hover {
      filter: grayscale(0%);
    }
  }

  .category-card__header {
    padding: var(--spacing-4);
    text-align: center;
    position: absolute;
    z-index: 1;
    bottom: var(--spacing-4);
    left: var(--spacing-4);
  }

  .category-card__name {
    margin: 0 0 var(--spacing-2) 0;
    font-size: var(--font-size-lg);
    font-weight: var(--font-weight-semibold);
    color: var(--color-white);
  }

  .category-card__count {
    margin: 0;
    font-size: var(--font-size-sm);
    color: var(--color-white);
  }
</style>
